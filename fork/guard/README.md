# 守护进程
## 特点
- 后台服务进程
- 独立于控制终端
- 周期性执行某任务
- 不受用户登录注销影响
- 一般采用以d结尾的名字(服务)
## 进程组
- 进程的组长:组里边的第一个进程(祖先)
- 进程组id为进程组组长的id(PGID)
## 会话-多个进程组
- 创建会话注意事项
- 1. 不能是进程组组长
- 2. 创建会话的进程成为(新进程组)的组长
- 3. 有些Linux操作系统需要root权限
- 4. 创建出的新会话会丢弃原有的控制终端
- 5. 一般步骤:先fork(),父亲死，儿子执行创建会话操作(setsid)
- 获取进程所属组的会话id
- * pid_t getsid(void);
- 创建一个会话
- * pid_t setsid(void);
## 创建守护进程模型
1. fork子进程，父进程退出[必须]
2. 子进程创建新会话[setsid]必须
3. 改变当前工作目录[chdir] 防止工作路径被避免[不是必须的]
4. 重设文件掩码 mode_t umask(mode_t mask)
- * 因为子进程会继承父进程掩码
- * 目的：增加程序灵活性
- * umask(0);最灵活
- * 不是必须的
5. 关闭文件描述符
- * 关闭标准输入，标准输出，标准错误
- * 目的：释放资源 因为守护进程不依赖终端不需要这些
- * 不是必须的
6. 执行核心工作程序
## 练习:
- 写一个守护进程，每隔2s获取一次系统时间，将时间写入到磁盘文件
